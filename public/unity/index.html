<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>MNET Monash Geoguessr</title>

     <!-- MazeMaps CSS -->
     <link rel="stylesheet" href="https://api.mazemap.com/js/v2.2.1/mazemap.min.css">
     <!-- App CSS -->
     <link rel="stylesheet" href="assets/css/app.css">
      <script type='text/javascript' src="https://api.mazemap.com/js/v2.2.1/mazemap.min.js" 
              onerror="console.error('Failed to load Maze Maps JavaScript library')"
              onload="console.log('Maze Maps JavaScript library loaded successfully', typeof mazemap, typeof window.mazemap)"></script>
  </head>

  <body style="text-align: center; padding: 0; border: 0; margin: 0; overflow: hidden;">
    <!-- wrapper container for positioning -->
    <div id="game-container" style="position: relative; display: inline-block; max-width: 100vw; max-height: 100vh; width: 100vw; height: 100vh;">
      <!-- unity canvas -->
      <canvas id="unity-canvas" width="%UNITY_WIDTH%" height="%UNITY_HEIGHT%" tabindex="-1" style="width: 100%; height: 100%; max-width: 100%; max-height: 100%; object-fit: contain; background: #231F20; display: block;"></canvas>

      <!-- Maze Map widget controls -->
      <div id="maze-map-ui" style="position: absolute; bottom: 20px; right: 20px; display: none;">
        <div class="mm-controls">
          <button class="mm-btn mm-expand" aria-label="Expand"></button>
          <button class="mm-btn mm-minimise" aria-label="Minimise"></button>
          <button class="mm-btn mm-pin" aria-label="Pin"></button>
        </div>

        <!-- Maze Map widget -->
        <div id="maze-map-widget" class="maze-map-widget mm-size-s">
          <div id="maze-maps-container" class="mazemap-container">
          <div id="map"></div>
          </div>
        </div>
        
        <!-- Guess Button -->
        <button id="guess-button" class="mm-guess-btn" disabled>
          PLACE YOUR PIN ON THE MAP
        </button>
	    </div>
    </div>
    <script src="%UNITY_WEBGL_LOADER_URL%"></script>
    <script>
      if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
        // Mobile device style: fill the whole browser client area with the game canvas:
        var meta = document.createElement('meta');
        meta.name = 'viewport';
        meta.content = 'width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, shrink-to-fit=yes';
        document.getElementsByTagName('head')[0].appendChild(meta);

        var gameContainer = document.querySelector("#game-container");
        var canvas = document.querySelector("#unity-canvas");
        
        // Make game container fill the viewport
        gameContainer.style.width = "100vw";
        gameContainer.style.height = "100vh";
        gameContainer.style.maxWidth = "none";
        gameContainer.style.maxHeight = "none";
        
        // Make canvas fill the container while maintaining aspect ratio
        canvas.style.width = "100%";
        canvas.style.height = "100%";
        canvas.style.maxWidth = "none";
        canvas.style.aspectRatio = "none";
        canvas.style.position = "fixed";

        document.body.style.textAlign = "left";
      }

      createUnityInstance(document.querySelector("#unity-canvas"), {
        arguments: [],
        dataUrl: "%UNITY_WEBGL_DATA_URL%",
        frameworkUrl: "%UNITY_WEBGL_FRAMEWORK_URL%",
        codeUrl: "%UNITY_WEBGL_CODE_URL%",
        streamingAssetsUrl: "StreamingAssets",
        companyName: "%COMPANY_NAME%",
        productName: "%PRODUCT_NAME%",
        productVersion: "%PRODUCT_VERSION%",
        // matchWebGLToCanvasSize: false,
        // devicePixelRatio: 1,
      }).then(function(unityInstance) {
        // Store Unity instance globally for access from other scripts
        window.unityInstance = unityInstance;
        window.gameInstance = unityInstance; // Also store as gameInstance for compatibility
        console.log("Unity instance created and stored globally");
      }).catch(function(message) {
        console.error("Unity instance creation failed:", message);
      });
    </script>
    <!-- App JS -->
    <script src="assets/js/app.js" defer></script>
  </body>
</html>
